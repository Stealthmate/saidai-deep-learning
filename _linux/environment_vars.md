---
layout: default
title: PATHとその他環境変数
toc: true
---
## 環境変数とは

プログラムを実行するというのは、ある**文脈**で行われることなので、その文脈をプログラムに知らせるために**環境変数**があります。例えば、LinuxでTerminalを起動したときに、`michael@michael-pc`という文字が出てくるのは、michaelというユーザーがTerminalを起動しているからです。つまり、「ユーザーがmichaelである」という文脈の中でTerminalが動いています。そして、「ユーザーがmichaelである」ということをTerminalに知らせるのは、`USER`という環境変数です。

Terminalで`env`というコマンドを打つと、そのTerminalに見えている全ての環境変数とその値が表示されます。そこで`USER`変数を探してみてください。値はあなたのユーザーネームになっているはずです。他にも`HOME`変数（現ユーザーのHOMEディレクトリの場所）や、`LANG`変数（現ユーザーが設定しているシステム言語）などもぜひ確認してみてください。

## PATH変数

Terminalで`gcc`や`python`など、様々なコマンドを実行できますよね。厳密に言えば、これらはコマンドではなくプログラムです\*。つまり、パソコンのどこかに`python`というファイルがあり、そのファイルを実行すると、pythonのインタープリタが起動します。しかし、Terminalはどうやって`python`ファイルの居場所が分かるのでしょう？

答えはPATH環境変数です。PATHの値はディレクトリのリストです。Terminalで`python`と打ったときに、shellはPATH変数のディレクトリを順番に見て、その中にpythonというファイルが存在すれば、それを実行します。

<div class="footnote">* コマンドはshell（Terminalでの入力を解釈しているもの）の中に組み込まれているものであり、プログラムはshellに関係なく存在するものである。例えば、lsはコマンドである（どこにlsというファイルが存在するわけではない）のに対し、pythonはプログラムである。</div>

## 環境変数の設定

Linuxでは様々なところで環境変数が設定されます。その中で一番身近にあるのが.profileファイルと.bashrcファイルです。この二つのファイルで環境変数を設定したり、その他の設定等もできます。.profileも.bashrcも全く同じように書式で書くものですが、違いがあります。

.profileは、システムにログインした時（電源を入れて起動したときや、SSHで接続した時など）だけに実行されます。つまり、最初にパソコンの電源を入れた時点で1回だけ実行され、そこで行った設定はその後で実行されたあらゆるプログラムで受け継げられます。

一方で.bashrcは、Terminalを起動した時点で実行されます。つまり、パソコンの電源を入れてから、例えば10個のTerminalを起動したら、それぞれの中で.bashrcが実行されます。そして、そのTerminalの中では.bashrcで行った設定が適用されます。

## .profileと.bashrcの書き方

.profileと.bashrcはshell scriptなので、shellの言語で書きます。ここでshellの言語について詳しくは説明しませんが、環境変数を設定したいときは以下のような書き方で書けます。

### 環境変数を新しく作る

```bash
export MY_VARIABLE="value"
```

これで`MY_VARIABLE`という変数に`value`という値が保存されます。

### 環境変数に値をくっつける

```bash
export PATH="$PATH:/my/directory"
```

これで、仮に`PATH`の値が`/home/michael`だった場合、新しくなった値は`/home/michael:/my/directory`になります。一般的に、`$VARIABLE`と書くと、`VARIABLE`の値を意味するので、どこに値をくっつけたいかによっては`export VARIABLE="value $VARIABLE"`や、`export VARIABLE=value1 $VARIABLE value2`などの書き方ができます。

### 環境変数を削除する

```bash
unset BAD_VARIABLE
```

これで`BAD_VARIABLE`は文脈から消え、元々なかったのと同じです。

## PATH変数を設定するときの注意点

PATH変数の値を自分で更新する時は多くありますが、そこで気をつけなければいけないところが何個かあります。

### PATHにディレクトリを追加する時、後ろに追加すること

shellがPATHでプログラムを探す時、左から順番に探して行きます。そして、最初にプログラムが見つかったディレクトリからプログラムを実行します。

`date`という、現在の日付を表示するプログラムを実行したとします。もし、あなたがPATHの頭にディレクトリを追加していて、たまたまそこに`date`というプログラムがあり、それが全く違うことをするプログラムだったら、求めている結果と違いますよね。パソコンでは、自分から実行しなくても、裏にあるソフトが色々なプログラムを実行したりします。その場合も同じくPATHが参照されるので、そこでこのような齟齬が起きたら、パソコンの動作が正しくなくなります。

### PATHの前の値を無視しないこと

PATHには予め様々なディレクトリが設定されています。それらはシステムが正しく動くためのものなので、PATHから無くなると、パソコンが動かなくなります。なので、PATHを変更する時は、常に前の値を維持したまま、`export PATH=$PATH:something`という形で後ろへの追加だけ行いましょう。
