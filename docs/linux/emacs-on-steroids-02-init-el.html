<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="/saidai-deep-learning/assets/css/syntax.css">
<link rel="stylesheet" type="text/css" href="/saidai-deep-learning/assets/css/style.css">
<script
  src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
  integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="
  crossorigin="anonymous"></script>
<script async type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  var isMobile = window.matchMedia('(max-width: 600px)').matches
  console.log(isMobile)
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
    },
    "HTML-CSS": {
      scale: isMobile ? 70 : 100,
      styles: {
        ".MathJax_Display": {
          width: isMobile ? "95%" : "100%"
        }
      }
    },
  });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Emacsの設定を変えてみる</title>
    <link rel="stylesheet" type="text/css" href="/saidai-deep-learning/assets/css/default.css">
  </head>
  <body>
    
    <nav>
      <a href="/saidai-deep-learning/">Home</a>
    </nav>
    <main>
      <header>
        <h2>
          <a href="/saidai-deep-learning/linux/home.html">Linuxについて</a>
        </h2>
        <h1>
	  
	  Emacs on Steroids 第2講:&nbsp;
	  
          Emacsの設定を変えてみる
        </h1>
        <details class="toc">
  <summary>
    目次
  </summary>
  <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#事前知識準備">事前知識・準備</a></li>
<li class="toc-entry toc-h1"><a href="#emacsの設定ファイル">Emacsの設定ファイル</a></li>
<li class="toc-entry toc-h1"><a href="#initelに書く内容">init.elに書く内容</a>
<ul>
<li class="toc-entry toc-h2"><a href="#行番号が常に表示されるように設定してみる">行番号が常に表示されるように設定してみる</a></li>
<li class="toc-entry toc-h2"><a href="#emacsの起動画面を無くしてみる">Emacsの起動画面を無くしてみる</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#emacsをスッキリさせるための簡単なカスタマイズ">Emacsをスッキリさせるための簡単なカスタマイズ</a></li>
<li class="toc-entry toc-h1"><a href="#まとめ">まとめ</a></li>
</ul>
</details>

      </header>
      <hr>
      <section>
        
<p><a href="/saidai-deep-learning/linux/emacs-on-steroids-01-basics.html">前回</a>では、Emacsの中にElispのインタプリタがあり、ほとんどの動作はElispで書かれたスクリプトの実行結果だと述べました。また、ショートカットの書き方や特徴についても述べました。今回は実際にElispを書きながら、Emacsの動作を変えて、新しいショートカットを作ってみます。</p>

<h1 id="事前知識準備">事前知識・準備</h1>

<ul>
  <li><a href="/saidai-deep-learning/linux/emacs-on-steroids-01-basics.html">Emacs基礎知識</a></li>
  <li>ユーザー名が<code class="highlighter-rouge">michael</code>だと仮定する</li>
</ul>

<h1 id="emacsの設定ファイル">Emacsの設定ファイル</h1>

<p>Emacsが起動するとき、<code class="highlighter-rouge">init.el</code>というファイルをまず最初にload（ロード・実行）します。<code class="highlighter-rouge">init.el</code>は普段、<code class="highlighter-rouge">~/.emacs.d/init.el</code>にあります。もし存在しなければ、作っておきましょう。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/.emacs.d/
<span class="nb">touch </span>init.el
</code></pre></div></div>

<p><code class="highlighter-rouge">init.el</code>の拡張子に注目しましょう。<code class="highlighter-rouge">.el</code>というのは予想通りElispから来ています。つまり、<code class="highlighter-rouge">init.el</code>はElispで書かれたスクリプトです。</p>

<h1 id="initelに書く内容"><code class="highlighter-rouge">init.el</code>に書く内容</h1>

<p>では、<code class="highlighter-rouge">init.el</code>に一体何を書けばいいでしょうか。簡単に言うと、命令を書きます。Pythonで<code class="highlighter-rouge">x = 3</code>と各のと同じように、Elispでも変数を定義したり、値を変更したり、処理を呼び出したりできます。少し抽象的に言うと、Emacsの<strong>状態</strong>を<strong>変更</strong>させます。例えば、文字の色が変数<code class="highlighter-rouge">char-color</code>に保存されているとしたら、その変数の値を<code class="highlighter-rouge">yellow</code>に変えることでEmacsの状態を変え、次に画面を描くときにEmacsがその新しい状態を使って、黄色い文字を描いてくれます。</p>

<h2 id="行番号が常に表示されるように設定してみる">行番号が常に表示されるように設定してみる</h2>

<p>テキストエディターを使うとき、行番号が表示されると位置を把握しやすいですね。Emacsではデフォルトで行番号が表示されないので、表示されるようにしましょう。そのために、<code class="highlighter-rouge">init.el</code>で以下を書きます：</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">global-display-line-numbers-mode</span> <span class="no">t</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">init.el</code>を保存して、Emacsを再起動してみてまた<code class="highlighter-rouge">init.el</code>を開いてみましょう。左側に行番号が表示されているはずです。</p>

<hr />

<p>では、上記のコードについて少し解説をしておきましょう。</p>

<p>まず、Elispでは全ての命令がカッコで囲まれます。なぜかと言うと、Elispのコードは全てリストから成るからです（豆知識：Lispという名前は<strong>Lis</strong>t <strong>P</strong>rocessor（列処理機）が由来です）。Elispで各リストはカッコで囲まれ、それぞれの要素をスペース区切りで書きます。なので、上のコードは2つの要素からなるリストで、それぞれ<code class="highlighter-rouge">global-display-line-numbers-mode</code>と<code class="highlighter-rouge">t</code>です。</p>

<p><code class="highlighter-rouge">global-display-line-numbers-mode</code>というのは、名前から分かると思いますが、<code class="highlighter-rouge">global</code>で（どこでも）<code class="highlighter-rouge">line numbers</code>（行番号）を<code class="highlighter-rouge">display</code>（表示）するモードです。一方<code class="highlighter-rouge">t</code>というのは<code class="highlighter-rouge">true</code>という値を表しています。つまり、<code class="highlighter-rouge">global-display-line-numbers-mode</code>を<code class="highlighter-rouge">true</code>にすることで、常に行番号が見えるようになります。</p>

<p>さてこれは変数の代入でしょうか。実は違います。変数の代入についてはまた次の節で解説しますが、上記の文は<strong>関数の呼び出し</strong>です。Elispでは、リストの頭に来る要素は常に関数の名前です。したがって、上記の文は、<code class="highlighter-rouge">global-display-line-numbers-mode</code>という関数を呼び出し、それに<code class="highlighter-rouge">t</code>という値を変数として渡しています。</p>

<p>では、<code class="highlighter-rouge">global-display-line-numbers-mode</code>はどのような関数でしょうか。<a href="/saidai-deep-learning/linux/emacs-on-steroids-01-basics.html">前回</a>説明した通り、<code class="highlighter-rouge">describe-function</code>（あるいは<code class="highlighter-rouge">C-h f</code>）を使うと、説明が出てきます。</p>

<blockquote>
  <p>Toggle Display-Line-Numbers mode in all buffers.</p>

  <p>With prefix <em>ARG</em>, enable Global Display-Line-Numbers mode if <em>ARG</em> is positive;</p>

  <p>otherwise, disable it. If called from Lisp, enable the mode if <em>ARG</em> is omitted or nil.</p>
</blockquote>

<p>全てのバッファー（開いているファイル）で、<code class="highlighter-rouge">Display-Line-Numbers mode</code>を有功にしてくれるそうです。さらに、もし引数を渡したら、それが正であれば有功にし、それ以外の場合を無効にしてくれるそうですね。なお、もし引数を渡していなければ、デフォルトで有功にしてくれると書いてあります。</p>

<h2 id="emacsの起動画面を無くしてみる">Emacsの起動画面を無くしてみる</h2>

<p>Emacsを起動するとき、このような画面が出てきますよね</p>

<p><img src="stealthmate.github.io/saidai-deep-learning/assets/images//linux/emacs-on-steroids-02-init-el/emacs-startup-screen.png" alt="Emacs Startup Screen" /></p>

<p>綺麗には見えますが、あまり使いみちがないですね。この画面を表示せずに、即タイピング可能な状態で起動するようにしてみましょう。<code class="highlighter-rouge">init.el</code>に以下を書いて、保存して、Emacsを再起動してみましょう：</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">setq</span> <span class="nv">inhibit-startup-message</span> <span class="no">t</span><span class="p">)</span>
</code></pre></div></div>

<p>画面が消えていますね！</p>

<hr />

<p>では、先程と同様に上の文を分析しましょう。今までの知識を使うと以下のことがいえます：</p>

<ul>
  <li>この文は<code class="highlighter-rouge">setq</code>関数を呼び出している</li>
  <li><code class="highlighter-rouge">setq</code>関数に引数<code class="highlighter-rouge">inhibit-startup-message</code>と<code class="highlighter-rouge">t</code>という2つの引数を渡している。</li>
</ul>

<p>では、<code class="highlighter-rouge">setq</code>関数について調べてみましょう。<code class="highlighter-rouge">C-h f setq RET</code>を打つと：</p>

<blockquote>
  <p>(setq [<em>SYM</em> <em>VAL</em>]…)</p>

  <p>Set each <em>SYM</em> to the value of its <em>VAL</em>.</p>

  <p>The symbols <em>SYM</em> are variables; they are literal (not evaluated).</p>

  <p>The values <strong>VAL</strong> are expressions; they are evaluated.</p>

  <p>Thus, (setq x (1+ y)) sets ‘x’ to the value of ‘(1+ y)’.</p>

  <p>The second <em>VAL</em> is not computed until after the first <em>SYM</em> is set, and so on;</p>

  <p>each <em>VAL</em> can use the new value of variables set earlier in the ‘setq’.</p>

  <p>The return value of the ‘setq’ form is the value of the last <em>VAL</em>.</p>
</blockquote>

<p>少し複雑ですが、要するに<code class="highlighter-rouge">SYM</code>の値を<code class="highlighter-rouge">VAL</code>に設定するということを言っています。真ん中らへんに書いてる例を見ると、<code class="highlighter-rouge">(setq x (1+ y))</code>は<code class="highlighter-rouge">x</code>に<code class="highlighter-rouge">(1+ y)</code>の値を代入すると書いてあります。</p>

<p>つまり、変数への代入も関数呼び出しで行っています。</p>

<hr />

<p>変数に値を代入する方法はこれでわかったと思います。しかし、値を代入している変数がそもそもどのようなものか、どこで使われてどのような値を取らなければいけないかは分からないですよね。そういうときに、<code class="highlighter-rouge">describe-function</code>とほとんど同じ<code class="highlighter-rouge">describe-variable</code>関数が役に立ってくれます！文字通り、<code class="highlighter-rouge">describe-variable</code>はある変数について教えてくれます。そしてショートカットは<code class="highlighter-rouge">C-h v</code>です。</p>

<p><em>Pro Tip: <code class="highlighter-rouge">C-h f</code>や<code class="highlighter-rouge">C-h k</code>と同様に、<code class="highlighter-rouge">C-h v</code>を<strong>h</strong>elp <strong>v</strong>ariableとして考えれば覚えやすいです！</em></p>

<p>では、<code class="highlighter-rouge">inhibit-startup-message</code>について調べてみましょう。<code class="highlighter-rouge">C-h v inhibit-startup-message RET</code>を打つと：</p>

<blockquote>
  <p>Documentation:</p>

  <p>Non-nil inhibits the startup screen.</p>
</blockquote>

<p>簡単ですね。<code class="highlighter-rouge">nil</code>以外の値は起動画面を無効にするそうです。</p>

<h1 id="emacsをスッキリさせるための簡単なカスタマイズ">Emacsをスッキリさせるための簡単なカスタマイズ</h1>

<p>Emacsを起動すると、上に他のソフトと同じメニュー（ファイル、編集、設定など）がありますね。更にその下に良く使う昨日のボタンがあり、画面の右側にスクロールバーもありますね。Emacsにある程度慣れれば、これらはむしろ邪魔だと思うようになります。なぜかと言うと、ショートカットを使いこなせていれば、わざわざマウスを動かしてボタンを押す動作をする必要がないからです。</p>

<p>皆さんに是非Emacsにそれぐらい慣れてほしいので、そのきっかけとして、上の3つのものを全部非表示にするためのカスタマイズ設定を載せておきます。それぞれ以下の通りです：</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">menu-bar-mode</span> <span class="mi">-1</span><span class="p">)</span> <span class="c1">;; メニューを消す</span>
<span class="p">(</span><span class="nv">tool-bar-mode</span> <span class="mi">-1</span><span class="p">)</span> <span class="c1">;; ボタンバーを消す</span>
<span class="p">(</span><span class="nv">scroll-bar-mode</span> <span class="mi">-1</span><span class="p">)</span> <span class="c1">;; スクロールバーを消す</span>
</code></pre></div></div>

<p><em>Pro Tip: Elispでは<code class="highlighter-rouge">;;</code>で行コメントが書けます！</em></p>

<p>上で説明した知識の範囲内なので、ぜひ各自でそれぞれの関数が何をしているか調べてみてください！</p>

<h1 id="まとめ">まとめ</h1>

<p>今回は<code class="highlighter-rouge">init.el</code>について説明し、簡単なElispの書き方を勉強しました。関数の呼び出しと変数の代入についてやり方を解説しまし、簡単なカスタマイズ設定をいくつか紹介しました。次回は、Emacsの様々な<em>mode</em>について解説したいと思います。</p>

      </section>
    </main>
  </body>
</html>
